--inici.html--
<?php include "includes/verificar-sessio.php"; ?>
<?php $_SESSION['url'] = $_SERVER['REQUEST_URI']; ?>
<?php ob_start(); ?>

<?php include "includes/header.html" ?>

<html>

<input type="hidden" name="redirurl" value="<? echo $_SERVER['HTTP_REFERER']; ?>" />

<h1>Benvingut a l'inici de l'intranet!</h1>
</html>




--login.php--
<?php
$dbhost = "localhost";
$dbuser = "phpmyadmin";
$dbpass = "%M4NUng41";
$dbname = "usuaris";

$conn = mysqli_connect($dbhost, $dbuser, $dbpass, $dbname);
if (!$conn) {
    die("S'ha perdut la connexió amb la base de dades. Informi d'aquest error inmediatament: " . mysqli_connect_error());
}

if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $identificador = $_POST["identificador"];
    $correu = $_POST["correu"];
    $contrasenya = $_POST["contrasenya"];

    $query = mysqli_query($conn, "SELECT * FROM comptes WHERE identificador = '" . $identificador . "' and correu = '" . $correu . "' and contrasenya = '" . $contrasenya ."'");
    $verificacio = mysqli_num_rows($query);

    if ($verificacio == 1) {
	header("Location: inici.html");
	exit;
        // Redirigim l'usuari a l'inici, ja que la sessió s'ha iniciat correctament
    } else {
        echo "<script> alert('Les credencials són incorrectes. Torni a intentar-ho');window.location= 'login.php' </script>";
        // Les dades són incorrectes pel que enviem un missatge d'error i redirigim l'usuari a la mateixa pàgina
    }
}

include "includes/header.html"

?>


<html>

<center>
    <form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>">
        <table>
            <tr>
                <td colspan="2" style="background-color:#33A8DB; padding-bottom:5px; padding-top:5px;">
                    <label>Inici de sessió</label>
                </td>
            </tr>
            <tr>
                <td align="center" rowspan="6"><img src="img/dpjusticia.png" /></td>
                <td><label>Identificador</label></td>
            </tr>
            <tr>
                <td><input type="text" name="identificador" /></td>
            </tr>
            <tr>
                <td><label>Correu electrònic</label></td>
            </tr>
            <tr>
                <td><input type="text" name="correu" /></td>
            </tr>
            <tr>
                <td><label>Contrasenya</label></td>
            </tr>
            <tr>
                <td><input type="password" name="contrasenya" /> </td>
            </tr>
            <tr>
                <td><input type="submit" value="Accedir" /> </td>
            </tr>
        </table>
    </form>
</center>

</html>




--/includes/header.html--
<header>
	<link rel="stylesheet" type="text/css" href="../css/styles.css">
	<img src="img/dpjusticia.png" alt="Generalitat de Catalunya. Departament de Justícia" id="logo_generalitat">
	<h1 id="titol">Intranet de Brians 1</h1>
</header>




--/includes/verificar-sessio.php--
<?php

session_start();
if(!(isset($_SESSION['identificador'])))
{
    header("Location: login.php");
}

?>
